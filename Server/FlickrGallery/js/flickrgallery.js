!function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=1)}([function(e,t){e.exports=jQuery},function(e,t,a){(function(e){var t=a(2),o=a(3),n=a(5),r=a(6);!function(e,a,s,l){e(s).ready((function(){ConnectFlickrGallery.loadData()})),a.ConnectFlickrGallery={modules:{},loadData:function(){var a=this;e(".flickrGallery").each((function(o,n){a.modules[e(n).data("moduleid")]={moduleId:e(n).data("moduleid"),tabId:e(n).data("tabid"),resources:e(n).data("resources"),security:e(n).data("security"),viewType:e(n).data("viewtype"),service:new t(e,e(n).data("moduleid"))}})),e(".photoGallery").each((function(t,n){React.render(React.createElement(o,{module:a.modules[e(n).data("moduleid")],photos:e(n).data("photos"),albumId:e(n).data("albumid"),photoList:e(n).data("list")}),n)})),e(".refreshButton").each((function(t,o){React.render(React.createElement(n,{module:a.modules[e(o).data("moduleid")]}),o)})),e(".flickrUpload").each((function(t,o){React.render(React.createElement(r,{module:a.modules[e(o).data("moduleid")],albums:e(o).data("albums"),returnUrl:e(o).data("returnurl")}),o)}))}}}(e,window,document)}).call(this,a(0))},function(e,t){e.exports=function(e,t){var a=t;this.baseServicepath=e.dnnSF(a).getServiceRoot("Connect/FlickrGallery"),this.ajaxCall=function(t,o,n,r,s,l,i){e.ajax({type:t,url:this.baseServicepath+o+"/"+n+(null!=r?"/"+r:""),beforeSend:e.dnnSF(a).setModuleHeaders,data:s}).done((function(e){null!=l&&l(e)})).fail((function(e,t){null!=i&&i(e.responseText)}))},this.nextGallerySegment=function(e,t,a,o){this.ajaxCall("GET","Photos","Page",e,{albumId:t},a,o)},this.refresh=function(e,t){this.ajaxCall("POST","Synchronization","SyncModule",null,null,e,t)},this.sendFile=function(e,t,a,o){this.ajaxCall("POST","Photos","Send",null,{fileName:e.fileName,newName:e.newName,albumName:t},a,o)}}},function(e,t,a){(function(t){var o=a(4);e.exports=React.createClass({displayName:"exports",getInitialState:function(){return{photos:this.props.photos,currentPage:0,lastPage:this.props.photos.length<50,loading:!1}},onMoreClick:function(e){e.preventDefault(),this.loadNextSegment()},hookUpSwipe:function(){var e=this;t(".cfg-gallery figure").unbind("click");var a=document.querySelectorAll(".pswp")[0];t(".cfg-gallery figure").click((function(o){var n={index:t(o.currentTarget).index()};new PhotoSwipe(a,PhotoSwipeUI_Default,e.props.photoList,n).init(),o.preventDefault()})),t(".pswp").click((function(e){e.preventDefault()}))},loadNextSegment:function(){var e=this;this.state.loading||this.setState({loading:!0},(function(){e.props.module.service.nextGallerySegment(e.state.currentPage+1,e.props.albumId,(function(t){e.setState({photos:e.state.photos.concat(t),currentPage:e.state.currentPage+1,lastPage:t.length<50,loading:!1})}))}))},componentDidUpdate:function(){this.hookUpSwipe()},componentDidMount:function(){var e=this;t(document).ready((function(){t(window).scroll((function(){t(".scroll-next").length>0&&window.innerHeight+t(window).scrollTop()>t(".scroll-next").offset().top&&e.loadNextSegment()})),e.hookUpSwipe()}))},render:function(){var e=this.state.photos.map((function(e){return React.createElement(o,{photo:e,key:e.PhotoId})})),t=this.state.lastPage?null:React.createElement("a",{href:"#",className:"scroll-next",onClick:this.onMoreClick},this.props.module.resources.LoadMore);return React.createElement("div",{className:"cfg-gallery lstGallery",itemscope:!0,itemtype:"http://schema.org/ImageGallery"},e,t)}})}).call(this,a(0))},function(e,t){e.exports=React.createClass({displayName:"exports",getInitialState:function(){return{}},render:function(){var e=this.props.photo.LargeWidth+"x"+this.props.photo.LargeHeight;return React.createElement("figure",{itemprop:"associatedMedia",itemscope:!0,itemtype:"http://schema.org/ImageObject","data-src":this.props.photo.LargeUrl,"data-w":this.props.photo.LargeWidth,"data-h":this.props.photo.LargeHeight,"data-title":this.props.photo.Title},React.createElement("a",{href:this.props.photo.LargeUrl,itemprop:"contentUrl","data-size":e},React.createElement("img",{src:this.props.photo.LargeSquareThumbnailUrl,itemprop:"thumbnail",alt:"Image description",width:"150",height:"150"})),React.createElement("figcaption",{itemprop:"caption description"},this.props.photo.Title))}})},function(e,t){e.exports=React.createClass({displayName:"exports",getInitialState:function(){return{refreshing:!1}},refresh:function(e){var t=this;e.preventDefault(),this.state.refreshing||confirm(this.props.module.resources.RefreshConfirm)&&(this.setState({refreshing:!0}),this.props.module.service.refresh((function(){t.setState({refreshing:!1})})))},render:function(){var e=null;return this.props.module.security.IsAdmin&&(e=this.state.refreshing?React.createElement("span",{className:"dnnSecondaryAction disabled"},this.props.module.resources.Refreshing):React.createElement("a",{href:"#",className:"dnnSecondaryAction",onClick:this.refresh},this.props.module.resources.Refresh)),e}})},function(e,t,a){(function(t){function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e}).apply(this,arguments)}var n=a(7),r=a(8);e.exports=React.createClass({displayName:"exports",getInitialState:function(){var e="";return"Group"==this.props.module.viewType&&(e=this.props.module.resources.ThisGroup),"Album"==this.props.module.viewType&&(e=this.props.module.resources.ThisAlbum),{uploadedFiles:[],selectedAlbum:e,albums:this.props.albums}},fileUploaded:function(e,t){this.setState({uploadedFiles:this.state.uploadedFiles.concat(t)})},submitUploads:function(e){e.preventDefault(),this.sendNextInQueue()},setAlbumName:function(e){this.setState({selectedAlbum:e})},sendNextInQueue:function(){for(var e=this,t=null,a=[],o=0;o<this.state.uploadedFiles.length;o++){var n=this.state.uploadedFiles[o];null==t&!n.sent&&(t=n,n.sending=!0),a.push(n)}null!=t&&(this.setState({uploadedFiles:a}),this.props.module.service.sendFile(t,this.state.selectedAlbum,(function(a){t.sending=!1,t.sent=!0;for(var o=[],n=0;n<e.state.uploadedFiles.length;n++)o.push(e.state.uploadedFiles[n].newName==t.newName?t:e.state.uploadedFiles[n]);e.setState({uploadedFiles:o}),e.sendNextInQueue()})))},componentDidMount:function(){var e=this,a=this;t(document).ready((function(){Dropzone.autoDiscover=!1,Dropzone.options.flickrUploadDropzone={init:function(){this.on("success",a.fileUploaded)}},t("#flickrUploadDropzone").dropzone({acceptedFiles:".jpg,.png",url:e.props.module.service.baseServicepath+"Photos/SaveUploadedFile",headers:{moduleId:e.props.module.moduleId,tabId:e.props.module.tabId,RequestVerificationToken:t('[name="__RequestVerificationToken"]').val()},dictDefaultMessage:e.props.module.resources.UploadMessage,dictFallbackMessage:e.props.module.resources.UploadNotSupported,parallelUploads:1})}))},render:function(){for(var e=this,t=this.state.uploadedFiles.map((function(t){return React.createElement(n,o({upload:t,key:t.newName},e.props))})),a=!1,s=0;s<this.state.uploadedFiles.length;s++)this.state.uploadedFiles[s].sent||(a=!0);var l=a?React.createElement("a",{href:"#",className:"dnnPrimaryAction",onClick:this.submitUploads},this.props.module.resources.UploadToFlickr):null,i=a|0==this.state.uploadedFiles.length?null:React.createElement("a",{href:this.props.returnUrl,className:"dnnPrimaryAction"},this.props.module.resources.Return),c="User"==this.props.module.viewType?React.createElement(r,o({albums:this.state.albums,setAlbumName:this.setAlbumName},this.props)):null;return React.createElement("div",null,React.createElement("div",{ref:"dropzone",id:"flickrUploadDropzone",className:"dropzone"}),c,React.createElement("p",null,React.createElement("strong",null,this.props.module.resources.UploadTo," ",this.state.selectedAlbum)),t,React.createElement("input",{type:"hidden",id:"UploadedFiles",value:JSON.stringify(this.state.uploadedFiles)}),React.createElement("div",{className:"cfg-buttons"},React.createElement("a",{href:this.props.returnUrl,className:"dnnSecondaryAction"},this.props.module.resources.Cancel),l,i))}})}).call(this,a(0))},function(e,t){e.exports=React.createClass({displayName:"exports",getInitialState:function(){return{}},render:function(){var e=this.props.upload.sending?this.props.module.resources.sending:"";return React.createElement("div",{className:"cfg-uploaded-file"},this.props.upload.fileName," ",e)}})},function(e,t){e.exports=React.createClass({displayName:"exports",getInitialState:function(){return{}},changed:function(){var e=this.refs.albumDropdown.getDOMNode(),t="";t="-1"==e.options[e.selectedIndex].value?this.refs.newAlbumName.getDOMNode().value:e.options[e.selectedIndex].text,this.props.setAlbumName(t)},render:function(){var e=this.props.albums.map((function(e){return React.createElement("option",{value:e.AlbumId},e.Title)}));return React.createElement("div",{className:"cfg-album-selector"},React.createElement("p",null,React.createElement("strong",null,this.props.module.resources.Album)),React.createElement("div",null,React.createElement("select",{className:"form-control",id:"SelectedAlbum",ref:"albumDropdown",onChange:this.changed},React.createElement("option",{value:"-1"},this.props.module.resources.New),e)),React.createElement("table",{className:"cfg-table"},React.createElement("tr",null,React.createElement("td",{width:"100px;"},React.createElement("strong",null,this.props.module.resources.NewAlbum)),React.createElement("td",null,React.createElement("input",{type:"text",className:"form-control",id:"NewAlbum",ref:"newAlbumName",onChange:this.changed})))))}})}]);